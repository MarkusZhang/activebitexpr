This learns a preliminary code z, and an active bit vector a
Then do element-wise multiplication to obtain the hash code h

a is treated continuous here